
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../heap-analysis-helper/">
      
      
        <link rel="next" href="../help/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>heap - GEF - GDB Enhanced Features documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#command-heap" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="GEF - GDB Enhanced Features documentation" class="md-header__button md-logo" aria-label="GEF - GDB Enhanced Features documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GEF - GDB Enhanced Features documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              heap
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../screenshots/" class="md-tabs__link">
        
  
  
    
  
  Showroom

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../install/" class="md-tabs__link">
          
  
  
  Setup

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/" class="md-tabs__link">
        
  
  
    
  
  FAQ

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../testing/" class="md-tabs__link">
          
  
  
  Hacking GEF

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../aliases/" class="md-tabs__link">
          
  
  
  Commands

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../functions/base/" class="md-tabs__link">
          
  
  
  Functions

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://hugsy.github.io/gef-extras/" class="md-tabs__link">
        
  
  
    
  
  GEF-Extras

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../deprecated/" class="md-tabs__link">
        
  
  
    
  
  Deprecated

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../settings/context/" class="md-tabs__link">
          
  
  
  Settings

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="GEF - GDB Enhanced Features documentation" class="md-nav__button md-logo" aria-label="GEF - GDB Enhanced Features documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    GEF - GDB Enhanced Features documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../screenshots/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Showroom
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Setup
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compatibility
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Hacking GEF
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Hacking GEF
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Write extensions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/gef/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://hugsy.github.io/gef/coverage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coverage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aliases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    aliases
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../arch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    arch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aslr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    aslr
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../canary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    canary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../checksec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    checksec
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    context
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dereference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dereference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../edit-flags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    edit-flags
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../elf-info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    elf-info
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../entry-break/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    entry-break
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    eval
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../format-string-helper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    format-string-helper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gef/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gef
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gef-remote/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gef-remote
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../got/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    got
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../heap-analysis-helper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    heap-analysis-helper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    heap
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    heap
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#command-heap" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command heap
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main_arena-symbol" class="md-nav__link">
    <span class="md-ellipsis">
      
        main_arena symbol
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="main_arena symbol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#heap-chunks-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap chunks command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-chunk-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap chunk command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-arenas-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap arenas command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-set-arena-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap set-arena command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-bins-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap bins command
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="heap bins command">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#heap-bins-fast-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap bins fast command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-heap-bins-x-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        Other heap bins X command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-bins-tcache-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap bins tcache command
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    help
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hexdump/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hexdump
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../highlight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    highlight
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hijack-fd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hijack-fd
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    memory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../name-break/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    name-break
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    nop
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../patch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    patch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pcustom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pcustom
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pie/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pie
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../print-format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    print-format
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../process-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    process-search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../process-status/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    process-status
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../registers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    registers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reset-cache/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    reset-cache
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    scan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../search-pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    search-pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shellcode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    shellcode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    stub
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stepover/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    stepover
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../skipi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    skipi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    theme
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tmux-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tmux-setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trace-run/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    trace-run
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../version/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    version
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vmmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vmmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xfiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xfiles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xinfo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xinfo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../xor-memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xor-memory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Functions
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Functions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functions/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functions/bss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    bss
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functions/got/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    got
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functions/heap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    heap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../functions/stack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    stack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://hugsy.github.io/gef-extras/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GEF-Extras
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deprecated/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deprecated
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Settings
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Settings
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    context
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/dereference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dereference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/entry-break/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    entry-break
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/gef/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gef
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/got/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    got
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/heap-analysis-helper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    heap-analysis-helper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/heap-chunks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    heap-chunks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/hexdump/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hexdump
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/highlight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    highlight
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/pcustom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pcustom
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/print-format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    print-format
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/process-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    process-search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/search-pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    search-pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/theme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    theme
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../settings/trace-run/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    trace-run
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#command-heap" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command heap
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main_arena-symbol" class="md-nav__link">
    <span class="md-ellipsis">
      
        main_arena symbol
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="main_arena symbol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#heap-chunks-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap chunks command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-chunk-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap chunk command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-arenas-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap arenas command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-set-arena-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap set-arena command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-bins-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap bins command
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="heap bins command">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#heap-bins-fast-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap bins fast command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-heap-bins-x-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        Other heap bins X command
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heap-bins-tcache-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        heap bins tcache command
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>heap</h1>

<h2 id="command-heap">Command <code>heap</code></h2>
<p>The <code>heap</code> command provides information on the heap chunk specified as argument. For the moment, it
only supports GlibC heap format (see <a href="https://code.woboq.org/userspace/glibc/malloc/malloc.c.html#malloc_chunk">this
link</a> for <code>malloc</code>
structure information). Syntax to the subcommands is straight forward:</p>
<pre><code class="language-text">gef➤ heap &lt;sub_commands&gt;
</code></pre>
<h2 id="main_arena-symbol"><code>main_arena</code> symbol</h2>
<p>If the linked glibc of the target program does not have debugging symbols it might be tricky for GEF
to find the address of the <code>main_arena</code> which is needed for most of the <code>heap</code> subcommands. If you
know the offset of this symbol from the glibc base address you can use GEF's config to provide said
value:</p>
<pre><code class="language-text">gef➤ gef config gef.main_arena_offset &lt;offset&gt;
</code></pre>
<p>If you do not know this offset and you want GEF to try and find it via bruteforce when executing a
<code>heap</code> command the next time, you can try this instead:</p>
<pre><code class="language-text">gef➤ gef config gef.bruteforce_main_arena True
</code></pre>
<p>Note that this might take a few seconds to complete. If GEF does find the symbol you can then
calculate the offset to the libc base address and save it in the config.</p>
<p>Sometimes, the dump might not contain proper info to help GEF find the libc version, which results in
failure to parse the arena information. In this case, you can try to provide GEF a specific libc
version to use with the following command:</p>
<pre><code class="language-text">gef➤ gef config gef.libc_version 2.31
</code></pre>
<h3 id="heap-chunks-command"><code>heap chunks</code> command</h3>
<p>Displays all the chunks from the <code>heap</code> section of the current arena.</p>
<pre><code class="language-text">gef➤ heap chunks
</code></pre>
<p><img alt="heap-chunks" src="assets/images/heap-chunks.png" /></p>
<p>To select from which arena to display chunks either use the <code>heap set-arena</code> command or provide the
base address of the other arena like this:</p>
<pre><code class="language-text">gef➤ heap chunks [arena_address]
</code></pre>
<p><img alt="heap-chunks-arena" src="assets/images/heap-chunks-arena.png" /></p>
<p>In order to display the chunks of all the available arenas at once use</p>
<pre><code class="language-text">gef➤ heap chunks -a
</code></pre>
<p><img alt="heap-chunks-all" src="assets/images/heap-chunks-all.png" /></p>
<p>Because usually the heap chunks are aligned to a certain number of bytes in memory GEF automatically
re-aligns the chunks data start addresses to match Glibc's behavior. To be able to view unaligned
chunks as well, you can disable this with the <code>--allow-unaligned</code> flag. Note that this might result
in incorrect output.</p>
<p>To get a higher level overview of the chunks you can use the <code>--summary</code> flag too.</p>
<pre><code class="language-text">gef➤ heap chunks --summary
</code></pre>
<p><img alt="heap-chunks-summary" src="assets/images/heap-chunks-summary.png" /></p>
<p>Sometimes, multiple types of objects could have the same size, hence it might not be enough only
knowing the chunk size when debugging issues like memory leaks. GEF supports using the vtable to
determine the type of the object stored in the chunk. To enable this feature, use <code>--resolve</code> along
with the <code>--summary</code> flag.</p>
<pre><code class="language-text">gef➤ heap chunks --summary --resolve
</code></pre>
<p><img alt="heap-chunks-summary-resolve" src="assets/images/heap-chunks-summary-resolve.png" /></p>
<p>Heap chunk command also supports filtering chunks by their size. To do so, simply provide the
<code>--min-size</code> or <code>--max-size</code> argument:</p>
<pre><code class="language-text">gef➤ heap chunks --min-size 16 --max-size 32
</code></pre>
<p><img alt="heap-chunks-size-filter" src="assets/images/heap-chunks-size-filter.png" /></p>
<p>The range is inclusive, so the above command will display all chunks with size &gt;=16 and &lt;=32.</p>
<p>If heap chunks command still gives too many chunks, we can use <code>--count</code> argument to limit the number
of the chunks in the output:</p>
<pre><code class="language-text">gef➤ heap chunks --count 1
</code></pre>
<p><img alt="heap-chunks-size-filter" src="assets/images/heap-chunks-size-filter.png" /></p>
<h3 id="heap-chunk-command"><code>heap chunk</code> command</h3>
<p>This command gives visual information of a Glibc malloc-ed chunked. Simply provide the address to
the user memory pointer of the chunk to show the information related to a specific chunk:</p>
<pre><code class="language-text">gef➤ heap chunk [address]
</code></pre>
<p><img alt="heap-chunk" src="assets/images/heap-chunk.png" /></p>
<p>Because usually the heap chunks are aligned to a certain number of bytes in memory GEF automatically
re-aligns the chunks data start addresses to match Glibc's behavior. To be able to view unaligned
chunks as well, you can disable this with the <code>--allow-unaligned</code> flag. Note that this might result
in incorrect output.</p>
<p>There is an optional <code>number</code> argument, to specify the number of chunks printed by this command. To
do so, simply provide the <code>--number</code> argument:</p>
<pre><code class="language-text">gef➤ heap chunk --number 6 0x4e5400
Chunk(addr=0x4e5400, size=0xd0, flags=PREV_INUSE)
Chunk(addr=0x4e54d0, size=0x1a0, flags=PREV_INUSE)
Chunk(addr=0x4e5670, size=0x200, flags=PREV_INUSE)
Chunk(addr=0x4e5870, size=0xbc0, flags=PREV_INUSE)
Chunk(addr=0x4e6430, size=0x330, flags=PREV_INUSE)
Chunk(addr=0x4e6760, size=0x4c0, flags=PREV_INUSE)

</code></pre>
<h3 id="heap-arenas-command"><code>heap arenas</code> command</h3>
<p>Multi-threaded programs have different arenas, and the knowledge of the <code>main_arena</code> is not enough.
<code>gef</code> therefore provides the <code>arena</code> sub-commands to help you list all the arenas allocated in your
program <strong>at the moment you call the command</strong>.</p>
<p><img alt="heap-arenas" src="assets/images/heap-arenas.png" /></p>
<h3 id="heap-set-arena-command"><code>heap set-arena</code> command</h3>
<p>In cases where the debug symbol are not present (e.g. statically stripped binary), it is possible to
instruct GEF to find the <code>main_arena</code> at a different location with the command:</p>
<pre><code class="language-text">gef➤ heap set-arena [address]
</code></pre>
<p>If the arena address is correct, all <code>heap</code> commands will be functional, and use the specified
address for <code>main_arena</code>.</p>
<h3 id="heap-bins-command"><code>heap bins</code> command</h3>
<p>Glibc uses bins for keeping tracks of <code>free</code>d chunks. This is because making allocations through
<code>sbrk</code> (requiring a syscall) is costly. Glibc uses those bins to remember formerly allocated chunks.
Because bins are structured in single or doubly linked list, I found that quite painful to always
interrogate <code>gdb</code> to get a pointer address, dereference it, get the value chunk, etc... So I decided
to implement the <code>heap bins</code> sub-command, which allows to get info on:</p>
<ul>
<li><code>fastbins</code></li>
<li><code>bins</code></li>
<li><code>unsorted</code></li>
<li><code>small bins</code></li>
<li><code>large bins</code></li>
<li><code>tcachebins</code></li>
</ul>
<h4 id="heap-bins-fast-command"><code>heap bins fast</code> command</h4>
<p>When exploiting heap corruption vulnerabilities, it is sometimes convenient to know the state of the
<code>fastbinsY</code> array.</p>
<p>The <code>fast</code> sub-command helps by displaying the list of fast chunks in this array. Without any other
argument, it will display the info of the <code>main_arena</code> arena. It accepts an optional argument, the
address of another arena (which you can easily find using <code>heap arenas</code>).</p>
<pre><code class="language-text">gef➤ heap bins fast
──────────────────────── Fastbins for arena 0x7ffff7fb8b80 ────────────────────────
Fastbins[idx=0, size=0x20]  ←  Chunk(addr=0x555555559380, size=0x20, flags=PREV_INUSE)
Fastbins[idx=1, size=0x30] 0x00
Fastbins[idx=2, size=0x40] 0x00
Fastbins[idx=3, size=0x50] 0x00
Fastbins[idx=4, size=0x60] 0x00
Fastbins[idx=5, size=0x70] 0x00
Fastbins[idx=6, size=0x80] 0x00
</code></pre>
<h4 id="other-heap-bins-x-command">Other <code>heap bins X</code> command</h4>
<p>All the other subcommands (with the exception of <code>tcache</code>) for the <code>heap bins</code> work the same way as
<code>fast</code>. If no argument is provided, <code>gef</code> will fall back to <code>main_arena</code>. Otherwise, it will use the
address pointed as the base of the <code>malloc_state</code> structure and print out information accordingly.</p>
<h4 id="heap-bins-tcache-command"><code>heap bins tcache</code> command</h4>
<p>Modern versions of <code>glibc</code> use <code>tcache</code> bins to speed up multithreaded programs.  Unlike other bins,
<code>tcache</code> bins are allocated on a per-thread basis, so there is one set of <code>tcache</code> bins for each
thread.</p>
<pre><code class="language-text">gef➤ heap bins tcache [all] [thread_ids...]
</code></pre>
<p>Without any arguments, <code>heap bins tcache</code> will display the <code>tcache</code> for the current thread. <code>heap
bins tcache all</code> will show the <code>tcache</code>s for every thread, or you can specify any number of thread
ids to see the <code>tcache</code> for each of them. For example, use the following command to show the
<code>tcache</code> bins for threads 1 and 2.</p>
<pre><code class="language-text">gef➤ heap bins tcache 1 2
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>