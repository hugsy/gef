
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../testing/">
      
      
        <link rel="next" href="gef/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Write extensions - GEF - GDB Enhanced Features documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#extending-gef" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="GEF - GDB Enhanced Features documentation" class="md-header__button md-logo" aria-label="GEF - GDB Enhanced Features documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GEF - GDB Enhanced Features documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Write extensions
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../screenshots/" class="md-tabs__link">
        
  
  
    
  
  Showroom

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../install/" class="md-tabs__link">
          
  
  
  Setup

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../faq/" class="md-tabs__link">
        
  
  
    
  
  FAQ

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../testing/" class="md-tabs__link">
          
  
  
  Hacking GEF

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../commands/aliases/" class="md-tabs__link">
          
  
  
  Commands

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../functions/base/" class="md-tabs__link">
          
  
  
  Functions

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://hugsy.github.io/gef-extras/" class="md-tabs__link">
        
  
  
    
  
  GEF-Extras

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../deprecated/" class="md-tabs__link">
        
  
  
    
  
  Deprecated

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../settings/context/" class="md-tabs__link">
          
  
  
  Settings

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="GEF - GDB Enhanced Features documentation" class="md-nav__button md-logo" aria-label="GEF - GDB Enhanced Features documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    GEF - GDB Enhanced Features documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../screenshots/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Showroom
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Setup
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compatibility
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Hacking GEF
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Hacking GEF
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Write extensions
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Write extensions
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#extending-gef" class="md-nav__link">
    <span class="md-ellipsis">
      
        Extending GEF
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick start
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detailed-explanation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detailed explanation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customizing-context-panes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Customizing context panes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Customizing context panes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#context-pane-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context Pane API
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#context-layout-mapping-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context Layout Mapping API
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    <span class="md-ellipsis">
      
        API
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reference
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parsing-command-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parsing command arguments
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-new-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding new architectures
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="gef/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../debugging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Debugging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://hugsy.github.io/gef/coverage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coverage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Commands
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/aliases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    aliases
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/arch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    arch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/aslr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    aslr
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/canary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    canary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/checksec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    checksec
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    context
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/dereference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dereference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/edit-flags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    edit-flags
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/elf-info/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    elf-info
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/entry-break/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    entry-break
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/eval/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    eval
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/format-string-helper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    format-string-helper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/gef/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gef
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/gef-remote/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gef-remote
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/got/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    got
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/heap-analysis-helper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    heap-analysis-helper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/heap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    heap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    help
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/hexdump/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hexdump
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/highlight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    highlight
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/hijack-fd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hijack-fd
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    memory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/name-break/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    name-break
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/nop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    nop
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/patch/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    patch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/pcustom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pcustom
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/pie/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pie
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/print-format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    print-format
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/process-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    process-search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/process-status/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    process-status
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/registers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    registers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/reset-cache/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    reset-cache
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/scan/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    scan
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/search-pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    search-pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/shellcode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    shellcode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/stub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    stub
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/stepover/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    stepover
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/skipi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    skipi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/theme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    theme
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/tmux-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tmux-setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/trace-run/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    trace-run
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/version/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    version
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/vmmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vmmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/xfiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xfiles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/xinfo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xinfo
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/xor-memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xor-memory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Functions
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Functions
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/bss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    bss
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/got/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    got
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/heap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    heap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../functions/stack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    stack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://hugsy.github.io/gef-extras/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GEF-Extras
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../deprecated/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deprecated
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Settings
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Settings
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    context
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/dereference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    dereference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/entry-break/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    entry-break
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/gef/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    gef
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/got/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    got
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/heap-analysis-helper/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    heap-analysis-helper
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/heap-chunks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    heap-chunks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/hexdump/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    hexdump
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/highlight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    highlight
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/pcustom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pcustom
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/print-format/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    print-format
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/process-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    process-search
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/search-pattern/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    search-pattern
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/theme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    theme
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/trace-run/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    trace-run
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#extending-gef" class="md-nav__link">
    <span class="md-ellipsis">
      
        Extending GEF
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick start
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detailed-explanation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detailed explanation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customizing-context-panes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Customizing context panes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Customizing context panes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#context-pane-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context Pane API
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#context-layout-mapping-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context Layout Mapping API
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    <span class="md-ellipsis">
      
        API
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Reference
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parsing-command-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parsing command arguments
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-new-architectures" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding new architectures
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Write extensions</h1>

<h2 id="extending-gef">Extending GEF</h2>
<p><code>GEF</code> intends to provide a battery-included, quickly installable and crazy fast debugging
environment sitting on top of GDB.</p>
<p>But it most importantly provides all the primitives required to allow hackers to quickly create
their own commands. This page intends to summarize how to create advanced GDB commands in moments
using <code>GEF</code> as a library.</p>
<p>A <a href="https://github.com/hugsy/gef-extras">dedicated repository</a> was born to host <a href="https://github.com/hugsy/gef-extras/tree/main/scripts">external
scripts</a>. This repo is open to all for
contributions, no restrictions and the most valuable ones will be integrated into <code>gef.py</code>.</p>
<h2 id="quick-start">Quick start</h2>
<p>Here is the most basic skeleton for creating a new <code>GEF</code> command named <code>newcmd</code>:</p>
<pre><code class="language-python">@register
class NewCommand(GenericCommand):
    &quot;&quot;&quot;Dummy new command.&quot;&quot;&quot;
    _cmdline_ = &quot;newcmd&quot;
    _syntax_  = f&quot;{_cmdline_}&quot;
    # optionally
    # _examples_ = [f&quot;{_cmdline_} arg1 ...&quot;, ]
    # _aliases_ = [&quot;alias_to_cmdline&quot;, ]

    @only_if_gdb_running         # not required, ensures that the debug session is started
    def do_invoke(self, argv):
        # let's say we want to print some info about the architecture of the current binary
        print(f&quot;gef.arch={gef.arch}&quot;)
        # or showing the current $pc
        print(f&quot;gef.arch.pc={gef.arch.pc:#x}&quot;)
</code></pre>
<p>Loading it in <code>GEF</code> is as easy as</p>
<pre><code class="language-text">gef➤  source /path/to/newcmd.py
[+] Loading 'NewCommand'
</code></pre>
<p>The new command is now loaded and part of GEF and can be invoked as such:</p>
<pre><code class="language-text">gef➤  newcmd
gef.arch=&lt;__main__.X86_64 object at 0x7fd5583571c0&gt;
gef.arch.pc=0x55555555a7d0
</code></pre>
<p>Yes, that's it! Check out <a href="gef/">the complete API</a> to see what else GEF offers.</p>
<h2 id="detailed-explanation">Detailed explanation</h2>
<p>Our new command must be a class that inherits from GEF's <code>GenericCommand</code>. The <em>only</em> requirements are:</p>
<ul>
<li>a <code>_cmdline_</code> attribute (the command to type on the GDB prompt).</li>
<li>a <code>_syntax_</code> attribute, which GEF will use to auto-generate the help menu.</li>
<li>a method <code>do_invoke(self, args)</code> which will be executed when the command is invoked. <code>args</code> is a
  list of the command line args provided when invoked.</li>
</ul>
<p>We make GEF aware of this new command by registering it in the <code>__main__</code> section of the script, by
invoking the global function <code>register_external_command()</code>.</p>
<p>Now you have a new GEF command which you can load, either from cli:</p>
<pre><code class="language-text">gef➤  source /path/to/newcmd.py
</code></pre>
<p>or add to your <code>~/.gdbinit</code>:</p>
<pre><code class="language-bash">echo source /path/to/newcmd.py &gt;&gt; ~/.gdbinit
</code></pre>
<h2 id="customizing-context-panes">Customizing context panes</h2>
<p>Sometimes you want something similar to a command to run on each break-like event and display itself
as a part of the GEF context. This can be achieved using the following
function <code>register_external_context_pane()</code>.</p>
<p>Here is a simple example of how to make a custom context pane:</p>
<pre><code class="language-python">__start_time__ = int(time.time())
def wasted_time_debugging():
    gef_print(&quot;You have wasted {} seconds!&quot;.format(int(time.time()) - __start_time__))

def wasted_time_debugging_title():
    return &quot;wasted:time:debugging:{}&quot;.format(int(time.time()) - __start_time__)

register_external_context_pane(&quot;wasted_time_debugging&quot;, wasted_time_debugging, wasted_time_debugging_title)
</code></pre>
<p>Loading it in <code>GEF</code> is as easy as loading a command</p>
<pre><code class="language-text">gef➤  source /path/to/custom_context_pane.py
</code></pre>
<p>It can even be included in the same file as a Command. Now on each break you will notice a new pane
near the bottom of the context. The order can be modified in the <code>GEF</code> context config.</p>
<h3 id="context-pane-api">Context Pane API</h3>
<p>The API demonstrated above requires very specific argument types:</p>
<pre><code class="language-python">def register_external_context_pane(
    name: str,
    context_callback: Callable[None,[]],
    context_callback_title: Callable[str, []],
    condition_callback: Optional[Callable[bool, []]] = None
) -&gt; None:
</code></pre>
<ul>
<li><code>name</code>: a string that will be used as the panes setting name</li>
<li><code>context_callback</code>: a function that uses <code>gef_print()</code> to print content in the pane</li>
<li><code>context_callback_title</code>: a function that returns the title string or None to hide the title</li>
<li><code>condition_callback</code> (optional): a function that returns a boolean deciding whether this context
 pane should be shown</li>
</ul>
<h3 id="context-layout-mapping-api">Context Layout Mapping API</h3>
<p>This API is designed for registering a new layout mapping for a GEF Context View. It specifies
the interface for the function register_external_context_layout_mapping which operates similarly
to the previously discussed register_external_context_pane. Pane must have been previously
established in the layout configuration.</p>
<pre><code class="language-python">def register_external_context_layout_mapping(
    current_pane_name: str,
    display_pane_function: Callable[[], None],
    pane_title_function: Callable[[], Optional[str]],
    condition: Optional[Callable[[], bool]] = None
) -&gt; None:
</code></pre>
<p>Registers a new mapping for an existing pane within the GEF Context View.</p>
<ul>
<li><code>current_pane_name</code>: the name of an already registered pane in the layout</li>
<li><code>display_pane_function</code>: a function that prints content in the pane using <code>gef_print()</code></li>
<li><code>pane_title_function</code>: a function that returns a string to be used as the pane title or
None if no title should be displayed</li>
<li><code>condition</code>: (optional) a predicate function that must return True for the pane content
and title to be displayed; if it returns False, the pane is skipped</li>
</ul>
<h2 id="api">API</h2>
<p>Some of the most important parts of the API for creating new commands are mentioned (but not limited
to) below. To see the full help of a function, open GDB and GEF, and use the embedded Python
interpreter's <code>help</code> command.</p>
<p>For example:</p>
<pre><code class="language-bash">gef➤  pi help(Architecture)
</code></pre>
<p>or even from outside GDB:</p>
<pre><code class="language-bash">gdb -q -ex 'pi help(hexdump)' -ex quit
</code></pre>
<p>The GEF API aims to provide a simpler and more Pythonic approach to GDB's.</p>
<p>Some basic examples:</p>
<ul>
<li>read the memory</li>
</ul>
<pre><code class="language-text">gef ➤  pi print(hexdump( gef.memory.read(parse_address(&quot;$pc&quot;), length=0x20 )))
0x0000000000000000     f3 0f 1e fa 31 ed 49 89 d1 5e 48 89 e2 48 83 e4    ....1.I..^H..H..
0x0000000000000010     f0 50 54 4c 8d 05 66 0d 01 00 48 8d 0d ef 0c 01    .PTL..f...H.....
</code></pre>
<ul>
<li>get access to the memory layout</li>
</ul>
<pre><code class="language-text">gef ➤ pi print('\n'.join([ f&quot;{x.page_start:#x} -&gt; {x.page_end:#x}&quot; for x in gef.memory.maps]))
0x555555554000 -&gt; 0x555555558000
0x555555558000 -&gt; 0x55555556c000
0x55555556c000 -&gt; 0x555555575000
0x555555576000 -&gt; 0x555555577000
0x555555577000 -&gt; 0x555555578000
0x555555578000 -&gt; 0x55555559a000
0x7ffff7cd8000 -&gt; 0x7ffff7cda000
0x7ffff7cda000 -&gt; 0x7ffff7ce1000
0x7ffff7ce1000 -&gt; 0x7ffff7cf2000
0x7ffff7cf2000 -&gt; 0x7ffff7cf7000
[...]
</code></pre>
<p>The API also offers a number of decorators to simplify the creation of new/existing commands, such as:</p>
<ul>
<li><code>@only_if_gdb_running</code> to execute only if a GDB session is running.</li>
<li><code>@only_if_gdb_target_local</code> to check if the target is local i.e. not debugging using GDB <code>remote</code>.</li>
<li>and many more...</li>
</ul>
<h3 id="reference">Reference</h3>
<p>For a complete reference of the API offered by GEF, visit <a href="gef/"><code>docs/api/gef.md</code></a>.</p>
<h3 id="parsing-command-arguments">Parsing command arguments</h3>
<pre><code class="language-python">@parse_arguments( {&quot;required_argument_1&quot;: DefaultValue1, ...}, {&quot;--optional-argument-1&quot;: DefaultValue1, ...} )
</code></pre>
<p>This decorator aims to facilitate the argument passing to a command. If added, it will use the
<code>argparse</code> module to parse arguments, and will store them in the <code>kwargs["arguments"]</code> of the
calling function (therefore the function <strong>must</strong> have <code>*args, **kwargs</code> added to its signature).
Argument type is inferred directly from the default value <strong>except</strong> for boolean, where a value of
<code>True</code> corresponds to <code>argparse</code>'s <code>store_true</code> action. For more details on <code>argparse</code>, refer to its
Python documentation.</p>
<p>Values given for the parameters also allow list of arguments being past. This can be useful in the
case where the number of exact option values is known in advance. This can be achieved simply by
using a type of <code>tuple</code> or <code>list</code> for the default value. <code>parse_arguments</code> will determine the type
of what to expect based on the first default value of the iterable, so make sure it's not empty. For
instance:</p>
<pre><code class="language-python">@parse_arguments( {&quot;instructions&quot;: [&quot;nop&quot;, &quot;int3&quot;, &quot;hlt&quot;], }, {&quot;--arch&quot;: &quot;x64&quot;, } )
</code></pre>
<p>Argument flags are also supported, allowing to write simpler version of the flag such as</p>
<pre><code class="language-python">@parse_arguments( {}, {(&quot;--long-argument&quot;, &quot;-l&quot;): value, } )
</code></pre>
<p>A basic example would be as follow:</p>
<pre><code class="language-python">class MyCommand(GenericCommand):
    [...]

    @parse_arguments({&quot;foo&quot;: [1,]}, {&quot;--bleh&quot;: &quot;&quot;, (&quot;--blah&quot;, &quot;-l): False})
    def do_invoke(self, argv, *args, **kwargs):
      args = kwargs[&quot;arguments&quot;]
      if args.foo == 1: ...
      if args.blah == True: ...
</code></pre>
<p>When the user enters the following command:</p>
<pre><code class="language-text">gef➤ mycommand --blah 3 14 159 2653
</code></pre>
<p>The function <code>MyCommand!do_invoke()</code> can use the command line argument value</p>
<pre><code class="language-python">args.foo == [3, 14, 159, 2653] # a List(int) from user input
args.bleh == &quot;&quot; # the default value
args.blah == True # set to True because user input declared the option (would have been False otherwise)
</code></pre>
<h3 id="adding-new-architectures">Adding new architectures</h3>
<p>Support for new architectures can be added by inheriting from the <code>Architecture</code> class. Examples can
be found in <a href="https://github.com/hugsy/gef-extras/tree/main/archs">gef-extras</a>.</p>
<p>Sometimes architectures can more precisely determine whether they apply to the current target by
looking at the architecture determined by gdb. For these cases the custom architecture may implement
the <code>supports_gdb_arch()</code> static function to signal that they should be used instead of the default.
The function receives only one argument:</p>
<ul>
<li><code>gdb_str</code> (of type <code>str</code>) which is the architecture name as reported by GDB.</li>
</ul>
<p>The function <strong>must</strong> return:</p>
<ul>
<li><code>True</code> if the current <code>Architecture</code> class supports the target binary; <code>False</code> otherwise.</li>
<li><code>None</code> to simply ignore this check and let GEF try to determine the architecture.</li>
</ul>
<p>One example is the ARM Cortex-M architecture which in some cases should be used over the generic ARM
one:</p>
<pre><code class="language-python">@staticmethod
def supports_gdb_arch(gdb_arch: str) -&gt; Optional[bool]:
    return bool(re.search(&quot;^armv.*-m$&quot;, gdb_arch))
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.instant", "navigation.tabs"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>